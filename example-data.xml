<?xml version="1.0" encoding="UTF-8"?>
<data xmlns="urn:ietf:params:xml:ns:netconf:base:1.0">
  <dns-server
      xmlns="http://www.nic.cz/ns/yang/dns-server"
      xmlns:tsig="http://www.nic.cz/ns/yang/tsig-algorithms"
      xmlns:dnssig="http://www.nic.cz/ns/yang/dnssec-signing"
      xmlns:knot="http://www.nic.cz/ns/yang/knot-dns">
    <description>Example DNS server configuration.</description>
    <server-options>
      <description>Server options.</description>
      <knot:async-start>true</knot:async-start>
      <chaos-identity>
	<id-server>I have no mouth and must scream.</id-server>
	<version>2.0</version>
      </chaos-identity>
      <nsid-identity>
	<nsid>myserver0.example.com</nsid>
      </nsid-identity>
      <listen-endpoint>
	<name>01</name>
	<ip-address>127.0.0.1</ip-address>
	<port>53531</port>
      </listen-endpoint>
      <listen-endpoint>
	<name>02</name>
	<ip-address>::1</ip-address>
      </listen-endpoint>
      <filesystem-paths>
	<run-time-dir>/tmp/knot</run-time-dir>
	<pid-file>knot.pid</pid-file>
      </filesystem-paths>
      <privileges>
	<user>knot</user>
	<group>wheel</group>
      </privileges>
      <resources>
	<knot:tcp-workers>3</knot:tcp-workers>
	<knot:udp-workers>42</knot:udp-workers>
      </resources>
      <response-rate-limiting>
	<table-size>1000000</table-size>
      </response-rate-limiting>
    </server-options>
    <knot:log>
      <knot:name>01</knot:name>
      <knot:syslog/>
      <knot:any>warning</knot:any>
    </knot:log>
    <knot:log>
      <knot:name>02</knot:name>
      <knot:file>/tmp/knot.log</knot:file>
      <knot:server>info</knot:server>
      <knot:zone>info</knot:zone>
    </knot:log>
    <access-control-list>
      <name>acl-xfr-update</name>
      <network>
        <name>01</name>
        <ip-prefix>127.0.0.1/32</ip-prefix>
      </network>
      <key>key0.server0</key>
      <operation>transfer</operation>
      <operation>update</operation>
    </access-control-list>
    <access-control-list>
      <name>acl-notify</name>
      <network>
        <name>01</name>
        <ip-prefix>::1/128</ip-prefix>
      </network>
      <network>
        <name>02</name>
        <ip-prefix>2001:db8::/64</ip-prefix>
      </network>
      <operation>notify</operation>
      <action>deny</action>
    </access-control-list>
    <access-control-list>
      <name>socket</name>
      <network>
	<name>01</name>
	<ip-prefix>192.0.2.0/28</ip-prefix>
      </network>
      <operation>control</operation>
    </access-control-list>
    <key>
      <name>key0.server0</name>
      <algorithm>tsig:hmac-sha256</algorithm>
      <secret>Wg==</secret>
    </key>
    <key>
      <name>key0.example.com</name>
      <description>slave key</description>
      <secret>Wg==</secret>
    </key>
    <remote-server>
      <name>server0</name>
      <remote>
	<ip-address>127.0.0.1</ip-address>
	<port>53531</port>
      </remote>
      <key>key0.server0</key>
      <local>
	<ip-address>127.0.0.1</ip-address>
	<port>6378</port>
      </local>
    </remote-server>
    <remote-server>
      <name>server1</name>
      <remote>
	<ip-address>2001:db8:0:1::1</ip-address>
      </remote>
      <key>key0.example.com</key>
    </remote-server>
    <knot:control-socket>
      <knot:ip-address>127.0.0.1</knot:ip-address>
      <knot:port>55553</knot:port>
      <knot:access-control-list>socket</knot:access-control-list>
    </knot:control-socket>
    <query-module>
      <type>knot:dnstap</type>
      <name>capture_all</name>
      <knot:dnstap>
	<knot:file>/tmp/capture.tap</knot:file>
      </knot:dnstap>
    </query-module>
    <query-module>
      <type>knot:dnsproxy</type>
      <name>default</name>
      <knot:dnsproxy>
	<knot:remote-server>
	  <knot:ip-address>10.0.1.1</knot:ip-address>
	</knot:remote-server>
      </knot:dnsproxy>
    </query-module>
    <query-module>
      <type>knot:rosedb</type>
      <name>default</name>
      <knot:rosedb>
	<knot:db-dir>/tmp/static_rrdb</knot:db-dir>
      </knot:rosedb>
    </query-module>
    <query-module>
      <type>knot:synth-record</type>
      <name>test1</name>
      <knot:synth-record>
	<knot:record-type>forward</knot:record-type>
	<knot:prefix>dynamic-</knot:prefix>
	<knot:ttl>400</knot:ttl>
	<knot:network>2620:0:b61::/52</knot:network>
      </knot:synth-record>
    </query-module>
    <query-module>
      <type>knot:synth-record</type>
      <name>test2</name>
      <knot:synth-record>
	<knot:record-type>reverse</knot:record-type>
	<knot:prefix>dynamic-</knot:prefix>
	<knot:origin>example</knot:origin>
	<knot:ttl>400</knot:ttl>
	<knot:network>2620:0:b61::/52</knot:network>
      </knot:synth-record>
    </query-module>
    <dnssig:sign-policy>
      <dnssig:name>default_rsa</dnssig:name>
      <dnssig:algorithm>RSASHA256</dnssig:algorithm>
      <dnssig:zsk-length>1024</dnssig:zsk-length>
      <dnssig:ksk-length>2048</dnssig:ksk-length>
    </dnssig:sign-policy>
    <zones>
      <template>
	<name>default</name>
	<description>Shared options for all zones.</description>
	<default>true</default>
	<zones-dir>/tmp/zones</zones-dir>
	<file>samples/%s.zone</file>
	<knot:semantic-checks>true</knot:semantic-checks>
	<any-to-tcp>true</any-to-tcp>
	<serial-update-method>unix-time</serial-update-method>
	<journal>
	  <from-differences>false</from-differences>
	  <zone-file-sync-delay>3600</zone-file-sync-delay>
	  <maximum-journal-size>1125899906842624</maximum-journal-size>
	</journal>
	<dnssec-signing>
	  <knot:kasp-db>/var/lib/knot/kasp</knot:kasp-db>
	</dnssec-signing>
	<query-module>
	  <type>knot:dnstap</type>
	  <name>capture_all</name>
	</query-module>
	<query-module>
	  <type>knot:dnsproxy</type>
	  <name>default</name>
	</query-module>
	<query-module>
	  <type>knot:rosedb</type>
	  <name>default</name>
	</query-module>
      </template>
      <zone>
	<domain>example.com</domain>
	<template>default</template>
	<master>server1</master>
	<notify>
	  <recipient>server0</recipient>
	</notify>
	<any-to-tcp>false</any-to-tcp>
	<access-control-list>acl-xfr-update</access-control-list>
	<access-control-list>acl-notify</access-control-list>
	<query-module>
	  <type>knot:synth-record</type>
	  <name>test1</name>
	</query-module>
	<query-module>
	  <type>knot:synth-record</type>
	  <name>test2</name>
	</query-module>
      </zone>
    </zones>
  </dns-server>
</data>
